import{j as e,r as p}from"./index-B4K3Jj8V.js";import{F as P,U as F,b as B,z as m,c as N,t as k,a as f,C as _,S as z,T as U}from"./textarea-DI6E-7VR.js";import{z as O,n as A,M as L,a3 as M,S as H,P as $}from"./index-BuIIpymt.js";import{d as q}from"./dayjs.min-DoqX9pzC.js";import{a as v,B as S,S as V}from"./button-B_ZE1LZO.js";import"./api.auth._provider.callback-B7nnFBLb.js";import"./index-DlBVl6G9.js";import{C as K,a as W,b as G}from"./card-Cl-91ziV.js";import{E as h,D as J,k as Q,l as X,m as Y,n as Z}from"./index-B6S418k8.js";import{P as R}from"./500-wHZx-rdF.js";import{I as ee}from"./input-FDDqKO9o.js";import{E as j}from"./resources-DmfYUWBd.js";import{b as te}from"./post-CCEhhlTv.js";import{g as ne}from"./get-default-title-DCbrmljW.js";import{u as se}from"./components-C3jcH-a4.js";import{S as ae}from"./show-sTpe4nC7.js";import{D as re}from"./delete-DTZjDWTC.js";import{C as oe}from"./clone-DNa-0_B5.js";(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},a=new t.Error().stack;a&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[a]="b618f030-44b1-4acd-b912-8052c0b93c52",t._sentryDebugIdIdentifier="sentry-dbid-b618f030-44b1-4acd-b912-8052c0b93c52")}catch{}})();const ie=({status:t,elements:{success:a=e.jsx(x,{translationKey:"autoSave.success",defaultMessage:"saved"}),error:n=e.jsx(x,{translationKey:"autoSave.error",defaultMessage:"auto save failed"}),loading:o=e.jsx(x,{translationKey:"autoSave.loading",defaultMessage:"saving ..."}),idle:l=e.jsx(x,{translationKey:"autoSave.idle",defaultMessage:"waiting for changes ..."})}={}})=>{switch(t){case"success":return e.jsx(e.Fragment,{children:a});case"error":return e.jsx(e.Fragment,{children:n});case"loading":return e.jsx(e.Fragment,{children:o});default:return e.jsx(e.Fragment,{children:l})}},x=({translationKey:t,defaultMessage:a})=>{const n=O();return e.jsxs("span",{className:v("text-sm text-muted-foreground",{"text-destructive":t==="autoSave.error","text-green-500":t==="autoSave.success"}),children:[n(t,a),t==="autoSave.success"&&` at ${q().format("HH:mm:ss")}`]})},le=({autoSave:t,modifyingDataBeforeSubmission:a,formProps:n,isWatchable:o,saveButtonProps:l,className:c,useFormModalClose:r,recordItemId:d,...s})=>{const u=p.useRef(!1),{resource:b,action:i}=A(),T=L(),I=i!==h.list||typeof i<"u"?T:void 0;o&&!u.current&&(u.current=!0,s.watch());const w=s.handleSubmit(me=>{const g=s.getValues(),E=a?a(g):g;s.refineCore.onFinish(E),r==null||r()}),{disabled:C}=l||{};return e.jsx(P,{...s,children:e.jsx("form",{...n,onSubmit:w,children:e.jsxs(K,{className:v("mx-auto space-y-4 border-none p-8 shadow-none",c),children:[e.jsx(W,{className:"space-y-4 p-0",children:s.children}),e.jsxs(G,{className:"flex gap-x-2 p-0",children:[e.jsx(y,{type:"submit",recordItemId:d,loading:s.refineCore.formLoading,disabled:C||!s.formState.isDirty}),!s.hideCancel&&e.jsx(S,{icon:e.jsx(F,{}),type:"button",onClick:r||I,disabled:s.refineCore.formLoading,variant:"outline",children:"Cancel"}),t&&e.jsx("div",{className:"ml-auto",children:e.jsx(ie,{...s.refineCore.autoSaveProps})})]})]})})})},y=({hideText:t=!1,children:a,accessControl:n,access:o,resource:l,recordItemId:c,...r})=>{const{label:d}=M(),s=n!=null&&n.enabled?H:V;return n!=null&&n.hideIfUnauthorized&&n.enabled?null:e.jsx(s,{params:{id:c},resource:l,action:"save",...o,children:e.jsx(S,{icon:e.jsx(B,{}),...r,children:!t&&(a??d)})})};y.displayName="SaveButton";const Be=({matches:t})=>[{title:ne(t)}],Ne={uiTools:()=>e.jsx(ce,{})};function ke(){const{initialData:t,categoriesRes:a}=se();return e.jsx(D,{initialData:t,categoriesRes:a})}function ce(){return e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(ae,{variant:"ghost",size:"icon"}),e.jsx(re,{variant:"ghost",size:"icon"}),e.jsx(oe,{variant:"ghost",size:"icon"})]})}function _e(){return e.jsx(R,{})}const de=m.object({title:m.string().min(2,{message:"Title must be at least 2 characters."}),content:m.string().min(2),status:m.string(),categoryId:m.string()}),ue=t=>{if(t)return{title:t.title,content:t.content,status:t.status,categoryId:t.categoryId}},D=({className:t,redirect:a=h.list,initialData:n,categoriesRes:o,useFormModalClose:l})=>{var b;let c=[];o?c=(b=o==null?void 0:o.data)==null?void 0:b.map(i=>({label:i.title,value:i.id})):c=$({resource:j.category}).options;const{data:r}=n||{},d=!0,s=N({resolver:k(de),defaultValues:ue(r),warnWhenUnsavedChanges:!0,refineCoreProps:{resource:j.post,action:r!=null&&r.id?h.edit:h.create,id:r==null?void 0:r.id,queryOptions:n?{queryFn:()=>n,initialData:n}:void 0,redirect:a,autoSave:{enabled:d,debounce:2e3,invalidateOnUnmount:!0,onFinish:i=>u(i)}}}),u=p.useCallback(i=>({...i}),[]);return e.jsxs(le,{...s,autoSave:d,modifyingDataBeforeSubmission:u,className:t,useFormModalClose:l,recordItemId:r==null?void 0:r.id,children:[e.jsx(f,{...s,name:"title",label:"Title",children:e.jsx(ee,{placeholder:"Title"})}),e.jsx(f,{...s,name:"categoryId",label:"Category",children:e.jsx(_,{options:c,popoverProps:{modal:!!l}})}),e.jsx(f,{...s,name:"status",label:"Status",children:e.jsx(z,{options:te.map(i=>({label:i,value:i}))})}),e.jsx(f,{...s,name:"content",label:"Content",children:e.jsx(U,{placeholder:"Content",rows:10})})]})};function ze(t){const{visible:a,close:n,record:o}=t;return e.jsx(J,{open:a,onOpenChange:n,children:e.jsxs(Q,{className:"max-w-6xl",children:[e.jsxs(X,{className:"border-b pb-4",children:[e.jsx(Y,{children:"Edit Post"}),e.jsx(Z,{children:"This is a Demo for Edit Form on Modal."})]}),e.jsx(D,{className:"p-0",useFormModalClose:n,initialData:o?{data:{...o}}:void 0})]})})}export{_e as E,D as P,ze as a,ke as b,Ne as h,Be as m};
//# sourceMappingURL=playground.article.post.edit._id-C08yVhyo.js.map
