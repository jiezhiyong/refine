import{j as e,r as j}from"./index-CrLFE0DV.js";import{F as C,U as E,b as P,z as u,c as B,t as N,a as m,C as k,S as _,T as z}from"./textarea-CZ1rN8KQ.js";import{z as U,u as O,M as A,a6 as L,S as M,P as H,a as R}from"./500-j-hvCCyY.js";import{d as $}from"./dayjs.min-Ca2IiHyT.js";import{a as p,B as v,S as q,E as b}from"./button-C4tA0yjF.js";import"./api.auth._provider.callback-3NBSYob1.js";import"./index-Bxu39dT-.js";import{C as V,a as K,b as W}from"./card-Dn9CSOY0.js";import{E as x,D as G,k as J,l as Q,m as X,n as Y}from"./index-CkeKAQ1O.js";import{I as Z}from"./input-D2rxz8SV.js";import{b as ee}from"./post-CCbUZ3ol.js";import{g as te}from"./get-default-title-8eq4dggU.js";import{u as se}from"./components-CpudPQLr.js";import{S as ne}from"./show-B6JMcv1C.js";import{D as ae}from"./delete-BEeP9mBs.js";import{C as re}from"./clone-_oUR5Fep.js";(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},a=new t.Error().stack;a&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[a]="e82f7de6-1dc2-4bbf-ba13-58655371f47b",t._sentryDebugIdIdentifier="sentry-dbid-e82f7de6-1dc2-4bbf-ba13-58655371f47b")}catch{}})();const oe=({status:t,elements:{success:a=e.jsx(f,{translationKey:"autoSave.success",defaultMessage:"saved"}),error:s=e.jsx(f,{translationKey:"autoSave.error",defaultMessage:"auto save failed"}),loading:o=e.jsx(f,{translationKey:"autoSave.loading",defaultMessage:"saving ..."}),idle:d=e.jsx(f,{translationKey:"autoSave.idle",defaultMessage:"waiting for changes ..."})}={}})=>{switch(t){case"success":return e.jsx(e.Fragment,{children:a});case"error":return e.jsx(e.Fragment,{children:s});case"loading":return e.jsx(e.Fragment,{children:o});default:return e.jsx(e.Fragment,{children:d})}},f=({translationKey:t,defaultMessage:a})=>{const s=U();return e.jsxs("span",{className:p("text-muted-foreground text-sm",{"text-destructive":t==="autoSave.error","text-green-500":t==="autoSave.success"}),children:[s(t,a),t==="autoSave.success"&&` at ${$().format("HH:mm:ss")}`]})},ie=({autoSave:t,modifyingDataBeforeSubmission:a,formProps:s,isWatchable:o,saveButtonProps:d,className:r,formModalClose:i,recordItemId:c,...n})=>{const l=j.useRef(!1),{resource:ue,action:h}=O(),D=A(),T=h!==x.list||typeof h<"u"?D:void 0;o&&!l.current&&(l.current=!0,n.watch());const F=n.handleSubmit(me=>{const g=n.getValues(),w=a?a(g):g;n.refineCore.onFinish(w),i==null||i()}),{disabled:I}=d||{};return e.jsx(C,{...n,children:e.jsx("form",{...s,onSubmit:F,children:e.jsxs(V,{className:p("mx-auto space-y-4 border-none p-8 shadow-none",r),children:[e.jsx(K,{className:"space-y-4 p-0",children:n.children}),e.jsxs(W,{className:"flex gap-x-2 p-0",children:[e.jsx(S,{type:"submit",recordItemId:c,loading:n.refineCore.formLoading,disabled:I||!n.formState.isDirty}),!n.hideCancel&&e.jsx(v,{icon:e.jsx(E,{}),type:"button",onClick:i||T,disabled:n.refineCore.formLoading,variant:"outline",children:"Cancel"}),t&&e.jsx("div",{className:"ml-auto",children:e.jsx(oe,{...n.refineCore.autoSaveProps})})]})]})})})},S=({hideText:t=!1,children:a,accessControl:s,access:o,resource:d,recordItemId:r,...i})=>{const{label:c}=L(),n=s!=null&&s.enabled?M:q;return s!=null&&s.hideIfUnauthorized&&s.enabled?null:e.jsx(n,{params:{id:r},resource:d,action:"save",...o,children:e.jsx(v,{icon:e.jsx(P,{}),...i,children:!t&&(a??c)})})};S.displayName="SaveButton";const Ee=({matches:t})=>[{title:te(t)}],Pe={uiTools:()=>e.jsx(ce,{})};function Be(){const{initialData:t}=se();return e.jsx(y,{initialData:t})}function ce(){return e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(ne,{variant:"ghost",size:"icon"}),e.jsx(ae,{variant:"ghost",size:"icon"}),e.jsx(re,{variant:"ghost",size:"icon"})]})}function Ne(){return e.jsx(H,{})}const le=u.object({title:u.string().min(2,{message:"Title must be at least 2 characters."}),content:u.string().min(2),status:u.string(),categoryId:u.string()}),de=t=>{if(t)return{title:t.title,content:t.content,status:t.status,categoryId:t.categoryId}},y=({className:t,redirect:a=x.list,initialData:s,formModalClose:o})=>{const d=R({resource:b.category}).options,{data:r}=s||{},i=!0,c=B({resolver:N(le),defaultValues:de(r),warnWhenUnsavedChanges:!0,refineCoreProps:{resource:b.post,action:r!=null&&r.id?x.edit:x.create,id:r==null?void 0:r.id,queryOptions:s?{queryFn:()=>s,initialData:s}:void 0,redirect:a,autoSave:{enabled:i,debounce:2e3,invalidateOnUnmount:!0,onFinish:l=>n(l)}}}),n=j.useCallback(l=>({...l}),[]);return e.jsxs(ie,{...c,autoSave:i,modifyingDataBeforeSubmission:n,className:t,formModalClose:o,recordItemId:r==null?void 0:r.id,children:[e.jsx(m,{...c,name:"title",label:"Title",children:e.jsx(Z,{placeholder:"Title"})}),e.jsx(m,{...c,name:"categoryId",label:"Category",children:e.jsx(k,{options:d,popoverProps:{modal:!!o}})}),e.jsx(m,{...c,name:"status",label:"Status",children:e.jsx(_,{options:ee.map(l=>({label:l,value:l}))})}),e.jsx(m,{...c,name:"content",label:"Content",children:e.jsx(z,{placeholder:"Content",rows:10})})]})};function ke(t){const{visible:a,close:s,record:o}=t;return e.jsx(G,{open:a,onOpenChange:s,children:e.jsxs(J,{className:"max-w-6xl",children:[e.jsxs(Q,{className:"border-b pb-4",children:[e.jsx(X,{children:"Edit Post"}),e.jsx(Y,{children:"This is a Demo for Edit Form on Modal."})]}),e.jsx(y,{className:"p-0",formModalClose:s,initialData:o?{data:{...o}}:void 0})]})})}export{Ne as E,y as P,ke as a,Be as b,Pe as h,Ee as m};
//# sourceMappingURL=playground.article.post.edit._id-Dd0LD6of.js.map
