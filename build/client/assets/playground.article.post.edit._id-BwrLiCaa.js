import{j as e,r as b}from"./index-jG6TLAuK.js";import{F as P,U as I,b as B,z as d,c as N,t as w,a as m,C as k,S as z,T as U}from"./textarea-CB_cDla-.js";import{z as O,u as A,M as L,a6 as M,S as _,P as H,a as R}from"./500-BA71UXe4.js";import{d as $}from"./dayjs.min-DhVwsScJ.js";import{a as v,B as p,S as q,E as g}from"./button-nJ3DiPmc.js";import"./index-D-Dx7sSn.js";import{C as V,a as K,b as W}from"./card-9CeW0Jrm.js";import{E as h,D as G,k as J,l as Q,m as X,n as Y}from"./index-B-b7VvUk.js";import{I as Z}from"./input-BlF4CSdU.js";import{b as ee}from"./post-Tv3N1-wS.js";import{g as te}from"./get-default-title-B-i1CURY.js";import{u as se}from"./components-L3uqpAeb.js";import{S as ae}from"./show-B8zOOzE2.js";import{D as ne}from"./delete-BnALbmmK.js";import{C as re}from"./clone-Rbl7Rj0-.js";const oe=({status:t,elements:{success:r=e.jsx(x,{translationKey:"autoSave.success",defaultMessage:"saved"}),error:s=e.jsx(x,{translationKey:"autoSave.error",defaultMessage:"auto save failed"}),loading:o=e.jsx(x,{translationKey:"autoSave.loading",defaultMessage:"saving ..."}),idle:u=e.jsx(x,{translationKey:"autoSave.idle",defaultMessage:"waiting for changes ..."})}={}})=>{switch(t){case"success":return e.jsx(e.Fragment,{children:r});case"error":return e.jsx(e.Fragment,{children:s});case"loading":return e.jsx(e.Fragment,{children:o});default:return e.jsx(e.Fragment,{children:u})}},x=({translationKey:t,defaultMessage:r})=>{const s=O();return e.jsxs("span",{className:v("text-muted-foreground text-sm",{"text-destructive":t==="autoSave.error","text-green-500":t==="autoSave.success"}),children:[s(t,r),t==="autoSave.success"&&` at ${$().format("HH:mm:ss")}`]})},ie=({autoSave:t,modifyingDataBeforeSubmission:r,formProps:s,isWatchable:o,saveButtonProps:u,className:n,formModalClose:i,recordItemId:c,...a})=>{const l=b.useRef(!1),{resource:de,action:f}=A(),F=L(),T=f!==h.list||typeof f<"u"?F:void 0;o&&!l.current&&(l.current=!0,a.watch());const C=a.handleSubmit(me=>{const j=a.getValues(),E=r?r(j):j;a.refineCore.onFinish(E),i==null||i()}),{disabled:D}=u||{};return e.jsx(P,{...a,children:e.jsx("form",{...s,onSubmit:C,children:e.jsxs(V,{className:v("mx-auto space-y-4 border-none p-8 shadow-none",n),children:[e.jsx(K,{className:"space-y-4 p-0",children:a.children}),e.jsxs(W,{className:"flex gap-x-2 p-0",children:[e.jsx(S,{type:"submit",recordItemId:c,loading:a.refineCore.formLoading,disabled:D||!a.formState.isDirty}),!a.hideCancel&&e.jsx(p,{icon:e.jsx(I,{}),type:"button",onClick:i||T,disabled:a.refineCore.formLoading,variant:"outline",children:"Cancel"}),t&&e.jsx("div",{className:"ml-auto",children:e.jsx(oe,{...a.refineCore.autoSaveProps})})]})]})})})},S=({hideText:t=!1,children:r,accessControl:s,access:o,resource:u,recordItemId:n,...i})=>{const{label:c}=M(),a=s!=null&&s.enabled?_:q;return s!=null&&s.hideIfUnauthorized&&s.enabled?null:e.jsx(a,{params:{id:n},resource:u,action:"save",...o,children:e.jsx(p,{icon:e.jsx(B,{}),...i,children:!t&&(r??c)})})};S.displayName="SaveButton";const Pe=({matches:t})=>[{title:te(t)}],Ie={uiTools:()=>e.jsx(ce,{})};function Be(){const{initialData:t}=se();return e.jsx(y,{initialData:t})}function ce(){return e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(ae,{variant:"ghost",size:"icon"}),e.jsx(ne,{variant:"ghost",size:"icon"}),e.jsx(re,{variant:"ghost",size:"icon"})]})}function Ne(){return e.jsx(H,{})}const le=d.object({title:d.string().min(2,{message:"Title must be at least 2 characters."}),content:d.string().min(2),status:d.string(),categoryId:d.string()}),ue=t=>{if(t)return{title:t.title,content:t.content,status:t.status,categoryId:t.categoryId}},y=({className:t,redirect:r=h.list,initialData:s,formModalClose:o})=>{const u=R({resource:g.category}).options,{data:n}=s||{},i=!0,c=N({resolver:w(le),defaultValues:ue(n),warnWhenUnsavedChanges:!0,refineCoreProps:{resource:g.post,action:n!=null&&n.id?h.edit:h.create,id:n==null?void 0:n.id,queryOptions:s?{queryFn:()=>s,initialData:s}:void 0,redirect:r,autoSave:{enabled:i,debounce:2e3,invalidateOnUnmount:!0,onFinish:l=>a(l)}}}),a=b.useCallback(l=>({...l}),[]);return e.jsxs(ie,{...c,autoSave:i,modifyingDataBeforeSubmission:a,className:t,formModalClose:o,recordItemId:n==null?void 0:n.id,children:[e.jsx(m,{...c,name:"title",label:"Title",children:e.jsx(Z,{placeholder:"Title"})}),e.jsx(m,{...c,name:"categoryId",label:"Category",children:e.jsx(k,{options:u,popoverProps:{modal:!!o}})}),e.jsx(m,{...c,name:"status",label:"Status",children:e.jsx(z,{options:ee.map(l=>({label:l,value:l}))})}),e.jsx(m,{...c,name:"content",label:"Content",children:e.jsx(U,{placeholder:"Content",rows:10})})]})};function we(t){const{visible:r,close:s,record:o}=t;return e.jsx(G,{open:r,onOpenChange:s,children:e.jsxs(J,{className:"max-w-6xl",children:[e.jsxs(Q,{className:"border-b pb-4",children:[e.jsx(X,{children:"Edit Post"}),e.jsx(Y,{children:"This is a Demo for Edit Form on Modal."})]}),e.jsx(y,{className:"p-0",formModalClose:s,initialData:o?{data:{...o}}:void 0})]})})}export{Ne as E,y as P,we as a,Be as b,Ie as h,Pe as m};
//# sourceMappingURL=playground.article.post.edit._id-BwrLiCaa.js.map
