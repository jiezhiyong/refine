import{j as e}from"./jsx-runtime-C-_spy54.js";import{u as it,t as lt,b as G,c as B,d as O,g as q,F as L,e as z,a as ct}from"./form-C6QjBNoK.js";import{T as dt,h as ut,k as mt,S as ft,a as pt}from"./index-hdkCHUwo.js";import{d as se}from"./dayjs.min-CHrC0Ux9.js";import{r as p}from"./index-aGVi9Z7h.js";import{t as we}from"./index-IcWDtlcJ.js";import{z as F}from"./index-Cb7h-Ku-.js";import{P as ht,S as xt}from"./layout-CBZaNUaE.js";import{N as bt}from"./404-DWlEIuVY.js";import{P as gt}from"./500-CUoB5SEY.js";import{C as jt}from"./create-D7Ur1QKT.js";import{E as yt}from"./edit-Dbx9bjfG.js";import{E as vt,T as H}from"./index-B6bDWxzb.js";import{C as Ct}from"./code-CpRwnOw5.js";import{C as St}from"./combobox-CP_l6vN3.js";import{S as wt}from"./select-multi-DdTJIlWD.js";import{A as kt,b as Rt,c as Dt,d as Nt,e as At,f as Pt,g as Et,h as Mt}from"./alert-dialog-CMOSIC-o.js";import{B as It}from"./badge-D4AhLx1S.js";import{u as ee,c as ae,B as me}from"./button-hXZAo1l1.js";import{C as Ft}from"./calendar-CGHvOIUG.js";import{C as xe}from"./checkbox-ymB5Ct45.js";import{D as Tt,a as _t,b as Vt,c as Kt,d as Bt,f as Ot}from"./dialog-DcmS6txE.js";import{I as pe}from"./input-CqjlsziW.js";import{P as Re,a as De,b as Ne}from"./popover-BoK46nO7.js";import{c as W,P as Gt,u as Ae}from"./index-D6J7U5p3.js";import{c as ye}from"./index-BTG9THwZ.js";import{P as te}from"./index-BivEtBZR.js";import{c as Pe,R as Lt,I as qt}from"./index-CSDw6qpf.js";import{u as Ee}from"./index-CBJO-X9V.js";import{u as Me}from"./index-BkIYOchD.js";import{u as Ie}from"./index-k7qIncBC.js";import zt from"./circle-B2Cqc5LX.js";import{c as Fe}from"./index-BdQq_4o_.js";import{c as Ht}from"./index-DscpCEPB.js";import{c as $t,T as Ut,a as Yt,b as Jt}from"./tooltip-Dp7GJdDQ.js";import{S as Wt}from"./switch-DmyV_4Wh.js";import{T as Xt}from"./textarea-mwnmNnuP.js";import{a as Qt}from"./typography-I680OglX.js";import{E as ue}from"./action-DSYjqVEc.js";import{E as Zt}from"./resource-BEg55So-.js";import{p as er,a as tr,s as rr}from"./playground.dashboard.dynamicPage.edit._id-k613t6SA.js";import{e as ke}from"./axios-DLE8MI3N.js";import{g as nr,d as or}from"./get-changed-values-vLde9APN.js";import{s as sr}from"./base-Dsx3AJoS.js";import{u as ar,a as ir,b as Te}from"./components-CzmxjdGq.js";import{u as lr}from"./index-DN0hhrBY.js";import cr from"./eye-AO_X0Y0s.js";import dr from"./link-2-DeYrdXb6.js";import ur from"./calendar-B_OcZrFE.js";import mr from"./check-check-BALC1p_C.js";import"./label-CQrdb056.js";import"./i18next-BaiEmIpz.js";import"./chevron-right-DGyas6Nx.js";import"./index-DAjhA2BA.js";import"./index-BBe4U18k.js";import"./index-j_Y29uav.js";import"./index-oFZnn4P-.js";import"./tslib.es6-DDzNqjJ8.js";import"./check-DuC-6lq_.js";import"./house-X5sWD9kf.js";import"./avatar-CkVpOwkP.js";import"./collapsible-BLcMGcob.js";import"./separator-ekGsPAzj.js";import"./x-DSx3Oiao.js";import"./panel-left-lDzCoLdX.js";import"./capitalize-first-letter-B7Vzw64t.js";import"./chevrons-up-down-D6CIMiNF.js";import"./baby-BsEDlitB.js";import"./log-out-60ux6PA3.js";import"./dynamic-icon-CJv2qwfF.js";import"./preload-helper-D7HrI6pR.js";import"./base-url-B9uMRsbQ.js";import"./roles-Bk5ifpzU.js";import"./biceps-flexed-D3S_LjaW.js";import"./audio-lines-CrG3NiE5.js";import"./gallery-vertical-end-DU-tXM4l.js";import"./plus-CDFR0Eer.js";import"./index-DUUtunIs.js";import"./tiny-invariant-CCoILDQG.js";import"./sun-BHLsAG4x.js";import"./moon-BaVgcbbb.js";import"./bug-aNpfW9HI.js";import"./bookmark-HhBJx0aF.js";import"./activity-gNb5n985.js";import"./isBrowser-BS1Xf4tW.js";import"./node-_8Bt17R8.js";import"./fullscreen-Dj6ecAaF.js";import"./languages-vwGZDUsx.js";import"./filter-x-Csih1RXe.js";import"./filter-B5NbLjqa.js";import"./search-P2vsbpZb.js";import"./circle-plus-e3zLOx1g.js";import"./pencil-C-2a-WqH.js";import"./download-Cc9t9nqP.js";import"./index--6MpHGvz.js";import"./isEqual-KSD6Iy0l.js";import"./index-CwDcuUm9.js";import"./command-UrgpALSp.js";import"./copy-check-BFPwZGwA.js";import"./trash-2-PoNELgpf.js";import"./select-C0JtVw_F.js";import"./index-FZ-fB8Tt.js";import"./chevron-down-tlukkpxr.js";import"./chevron-up-DsVAOids.js";import"./chevron-left-De2W4reu.js";import"./field-83Oe2ZIn.js";import"./form-C6Kqb6cn.js";import"./card-cVzU8pnd.js";import"./undo-2-BTw56Gmb.js";import"./form-BJoh7EuQ.js";import"./get-default-title-CrVGbO9H.js";import"./resources-nPXTaVLM.js";import"./lightbulb-ByMqiYOG.js";import"./grip-vertical-BGUneZMX.js";import"./square-pen-Bza4NaAe.js";var ve="Radio",[fr,_e]=ye(ve),[pr,hr]=fr(ve),Ve=p.forwardRef((t,r)=>{const{__scopeRadio:n,name:o,checked:a=!1,required:i,disabled:l,value:b="on",onCheck:x,form:m,...R}=t,[g,v]=p.useState(null),f=ee(r,D=>v(D)),k=p.useRef(!1),A=g?m||!!g.closest("form"):!0;return e.jsxs(pr,{scope:n,checked:a,disabled:l,children:[e.jsx(te.button,{type:"button",role:"radio","aria-checked":a,"data-state":Oe(a),"data-disabled":l?"":void 0,disabled:l,value:b,...R,ref:f,onClick:W(t.onClick,D=>{a||x==null||x(),A&&(k.current=D.isPropagationStopped(),k.current||D.stopPropagation())})}),A&&e.jsx(xr,{control:g,bubbles:!k.current,name:o,value:b,checked:a,required:i,disabled:l,form:m,style:{transform:"translateX(-100%)"}})]})});Ve.displayName=ve;var Ke="RadioIndicator",Be=p.forwardRef((t,r)=>{const{__scopeRadio:n,forceMount:o,...a}=t,i=hr(Ke,n);return e.jsx(Gt,{present:o||i.checked,children:e.jsx(te.span,{"data-state":Oe(i.checked),"data-disabled":i.disabled?"":void 0,...a,ref:r})})});Be.displayName=Ke;var xr=t=>{const{control:r,checked:n,bubbles:o=!0,...a}=t,i=p.useRef(null),l=Ie(n),b=Me(r);return p.useEffect(()=>{const x=i.current,m=window.HTMLInputElement.prototype,g=Object.getOwnPropertyDescriptor(m,"checked").set;if(l!==n&&g){const v=new Event("click",{bubbles:o});g.call(x,n),x.dispatchEvent(v)}},[l,n,o]),e.jsx("input",{type:"radio","aria-hidden":!0,defaultChecked:n,...a,tabIndex:-1,ref:i,style:{...t.style,...b,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})};function Oe(t){return t?"checked":"unchecked"}var br=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Ce="RadioGroup",[gr,ss]=ye(Ce,[Pe,_e]),Ge=Pe(),Le=_e(),[jr,yr]=gr(Ce),qe=p.forwardRef((t,r)=>{const{__scopeRadioGroup:n,name:o,defaultValue:a,value:i,required:l=!1,disabled:b=!1,orientation:x,dir:m,loop:R=!0,onValueChange:g,...v}=t,f=Ge(n),k=Ee(m),[A,D]=Ae({prop:i,defaultProp:a,onChange:g});return e.jsx(jr,{scope:n,name:o,required:l,disabled:b,value:A,onValueChange:D,children:e.jsx(Lt,{asChild:!0,...f,orientation:x,dir:k,loop:R,children:e.jsx(te.div,{role:"radiogroup","aria-required":l,"aria-orientation":x,"data-disabled":b?"":void 0,dir:k,...v,ref:r})})})});qe.displayName=Ce;var ze="RadioGroupItem",He=p.forwardRef((t,r)=>{const{__scopeRadioGroup:n,disabled:o,...a}=t,i=yr(ze,n),l=i.disabled||o,b=Ge(n),x=Le(n),m=p.useRef(null),R=ee(r,m),g=i.value===a.value,v=p.useRef(!1);return p.useEffect(()=>{const f=A=>{br.includes(A.key)&&(v.current=!0)},k=()=>v.current=!1;return document.addEventListener("keydown",f),document.addEventListener("keyup",k),()=>{document.removeEventListener("keydown",f),document.removeEventListener("keyup",k)}},[]),e.jsx(qt,{asChild:!0,...b,focusable:!l,active:g,children:e.jsx(Ve,{disabled:l,required:i.required,checked:g,...x,...a,name:i.name,ref:R,onCheck:()=>i.onValueChange(a.value),onKeyDown:W(f=>{f.key==="Enter"&&f.preventDefault()}),onFocus:W(a.onFocus,()=>{var f;v.current&&((f=m.current)==null||f.click())})})})});He.displayName=ze;var vr="RadioGroupIndicator",$e=p.forwardRef((t,r)=>{const{__scopeRadioGroup:n,...o}=t,a=Le(n);return e.jsx(Be,{...a,...o,ref:r})});$e.displayName=vr;var Cr=qe,Sr=He,wr=$e;function kr({className:t,...r}){return e.jsx(Cr,{"data-slot":"radio-group",className:ae("grid gap-3",t),...r})}function Rr({className:t,...r}){return e.jsx(Sr,{"data-slot":"radio-group-item",className:ae("border-input text-primary ring-ring/10 dark:ring-ring/20 dark:outline-ring/40 outline-ring/50 aspect-square size-4 shrink-0 rounded-full border shadow-xs transition-[color,box-shadow] focus-visible:ring-4 focus-visible:outline-1 disabled:cursor-not-allowed disabled:opacity-50 aria-invalid:focus-visible:ring-0",t),...r,children:e.jsx(wr,{"data-slot":"radio-group-indicator",className:"relative flex items-center justify-center",children:e.jsx(zt,{className:"fill-primary absolute top-1/2 left-1/2 size-2 -translate-x-1/2 -translate-y-1/2"})})})}var Ue=["PageUp","PageDown"],Ye=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],Je={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},ie="Slider",[be,Dr,Nr]=Ht(ie),[We,as]=ye(ie,[Nr]),[Ar,fe]=We(ie),Xe=p.forwardRef((t,r)=>{const{name:n,min:o=0,max:a=100,step:i=1,orientation:l="horizontal",disabled:b=!1,minStepsBetweenThumbs:x=0,defaultValue:m=[o],value:R,onValueChange:g=()=>{},onValueCommit:v=()=>{},inverted:f=!1,form:k,...A}=t,D=p.useRef(new Set),E=p.useRef(0),T=l==="horizontal"?Pr:Er,[M=[],Y]=Ae({prop:R,defaultProp:m,onChange:_=>{var U;(U=[...D.current][E.current])==null||U.focus(),g(_)}}),Q=p.useRef(M);function Z(_){const $=_r(M,_);J(_,$)}function re(_){J(_,E.current)}function le(){const _=Q.current[E.current];M[E.current]!==_&&v(M)}function J(_,$,{commit:U}={commit:!1}){const ne=Or(i),h=Gr(Math.round((_-o)/i)*i+o,ne),d=Fe(h,[o,a]);Y((j=[])=>{const s=Fr(j,d,$);if(Br(s,x*i)){E.current=s.indexOf(d);const c=String(s)!==String(j);return c&&U&&v(s),c?s:j}else return j})}return e.jsx(Ar,{scope:t.__scopeSlider,name:n,disabled:b,min:o,max:a,valueIndexToChangeRef:E,thumbs:D.current,values:M,orientation:l,form:k,children:e.jsx(be.Provider,{scope:t.__scopeSlider,children:e.jsx(be.Slot,{scope:t.__scopeSlider,children:e.jsx(T,{"aria-disabled":b,"data-disabled":b?"":void 0,...A,ref:r,onPointerDown:W(A.onPointerDown,()=>{b||(Q.current=M)}),min:o,max:a,inverted:f,onSlideStart:b?void 0:Z,onSlideMove:b?void 0:re,onSlideEnd:b?void 0:le,onHomeKeyDown:()=>!b&&J(o,0,{commit:!0}),onEndKeyDown:()=>!b&&J(a,M.length-1,{commit:!0}),onStepKeyDown:({event:_,direction:$})=>{if(!b){const h=Ue.includes(_.key)||_.shiftKey&&Ye.includes(_.key)?10:1,d=E.current,j=M[d],s=i*h*$;J(j+s,d,{commit:!0})}}})})})})});Xe.displayName=ie;var[Qe,Ze]=We(ie,{startEdge:"left",endEdge:"right",size:"width",direction:1}),Pr=p.forwardRef((t,r)=>{const{min:n,max:o,dir:a,inverted:i,onSlideStart:l,onSlideMove:b,onSlideEnd:x,onStepKeyDown:m,...R}=t,[g,v]=p.useState(null),f=ee(r,T=>v(T)),k=p.useRef(void 0),A=Ee(a),D=A==="ltr",E=D&&!i||!D&&i;function K(T){const M=k.current||g.getBoundingClientRect(),Y=[0,M.width],Z=Se(Y,E?[n,o]:[o,n]);return k.current=M,Z(T-M.left)}return e.jsx(Qe,{scope:t.__scopeSlider,startEdge:E?"left":"right",endEdge:E?"right":"left",direction:E?1:-1,size:"width",children:e.jsx(et,{dir:A,"data-orientation":"horizontal",...R,ref:f,style:{...R.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:T=>{const M=K(T.clientX);l==null||l(M)},onSlideMove:T=>{const M=K(T.clientX);b==null||b(M)},onSlideEnd:()=>{k.current=void 0,x==null||x()},onStepKeyDown:T=>{const Y=Je[E?"from-left":"from-right"].includes(T.key);m==null||m({event:T,direction:Y?-1:1})}})})}),Er=p.forwardRef((t,r)=>{const{min:n,max:o,inverted:a,onSlideStart:i,onSlideMove:l,onSlideEnd:b,onStepKeyDown:x,...m}=t,R=p.useRef(null),g=ee(r,R),v=p.useRef(void 0),f=!a;function k(A){const D=v.current||R.current.getBoundingClientRect(),E=[0,D.height],T=Se(E,f?[o,n]:[n,o]);return v.current=D,T(A-D.top)}return e.jsx(Qe,{scope:t.__scopeSlider,startEdge:f?"bottom":"top",endEdge:f?"top":"bottom",size:"height",direction:f?1:-1,children:e.jsx(et,{"data-orientation":"vertical",...m,ref:g,style:{...m.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:A=>{const D=k(A.clientY);i==null||i(D)},onSlideMove:A=>{const D=k(A.clientY);l==null||l(D)},onSlideEnd:()=>{v.current=void 0,b==null||b()},onStepKeyDown:A=>{const E=Je[f?"from-bottom":"from-top"].includes(A.key);x==null||x({event:A,direction:E?-1:1})}})})}),et=p.forwardRef((t,r)=>{const{__scopeSlider:n,onSlideStart:o,onSlideMove:a,onSlideEnd:i,onHomeKeyDown:l,onEndKeyDown:b,onStepKeyDown:x,...m}=t,R=fe(ie,n);return e.jsx(te.span,{...m,ref:r,onKeyDown:W(t.onKeyDown,g=>{g.key==="Home"?(l(g),g.preventDefault()):g.key==="End"?(b(g),g.preventDefault()):Ue.concat(Ye).includes(g.key)&&(x(g),g.preventDefault())}),onPointerDown:W(t.onPointerDown,g=>{const v=g.target;v.setPointerCapture(g.pointerId),g.preventDefault(),R.thumbs.has(v)?v.focus():o(g)}),onPointerMove:W(t.onPointerMove,g=>{g.target.hasPointerCapture(g.pointerId)&&a(g)}),onPointerUp:W(t.onPointerUp,g=>{const v=g.target;v.hasPointerCapture(g.pointerId)&&(v.releasePointerCapture(g.pointerId),i(g))})})}),tt="SliderTrack",rt=p.forwardRef((t,r)=>{const{__scopeSlider:n,...o}=t,a=fe(tt,n);return e.jsx(te.span,{"data-disabled":a.disabled?"":void 0,"data-orientation":a.orientation,...o,ref:r})});rt.displayName=tt;var ge="SliderRange",nt=p.forwardRef((t,r)=>{const{__scopeSlider:n,...o}=t,a=fe(ge,n),i=Ze(ge,n),l=p.useRef(null),b=ee(r,l),x=a.values.length,m=a.values.map(v=>st(v,a.min,a.max)),R=x>1?Math.min(...m):0,g=100-Math.max(...m);return e.jsx(te.span,{"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0,...o,ref:b,style:{...t.style,[i.startEdge]:R+"%",[i.endEdge]:g+"%"}})});nt.displayName=ge;var je="SliderThumb",ot=p.forwardRef((t,r)=>{const n=Dr(t.__scopeSlider),[o,a]=p.useState(null),i=ee(r,b=>a(b)),l=p.useMemo(()=>o?n().findIndex(b=>b.ref.current===o):-1,[n,o]);return e.jsx(Mr,{...t,ref:i,index:l})}),Mr=p.forwardRef((t,r)=>{const{__scopeSlider:n,index:o,name:a,...i}=t,l=fe(je,n),b=Ze(je,n),[x,m]=p.useState(null),R=ee(r,K=>m(K)),g=x?l.form||!!x.closest("form"):!0,v=Me(x),f=l.values[o],k=f===void 0?0:st(f,l.min,l.max),A=Tr(o,l.values.length),D=v==null?void 0:v[b.size],E=D?Vr(D,k,b.direction):0;return p.useEffect(()=>{if(x)return l.thumbs.add(x),()=>{l.thumbs.delete(x)}},[x,l.thumbs]),e.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[b.startEdge]:`calc(${k}% + ${E}px)`},children:[e.jsx(be.ItemSlot,{scope:t.__scopeSlider,children:e.jsx(te.span,{role:"slider","aria-label":t["aria-label"]||A,"aria-valuemin":l.min,"aria-valuenow":f,"aria-valuemax":l.max,"aria-orientation":l.orientation,"data-orientation":l.orientation,"data-disabled":l.disabled?"":void 0,tabIndex:l.disabled?void 0:0,...i,ref:R,style:f===void 0?{display:"none"}:t.style,onFocus:W(t.onFocus,()=>{l.valueIndexToChangeRef.current=o})})}),g&&e.jsx(Ir,{name:a??(l.name?l.name+(l.values.length>1?"[]":""):void 0),form:l.form,value:f},o)]})});ot.displayName=je;var Ir=t=>{const{value:r,...n}=t,o=p.useRef(null),a=Ie(r);return p.useEffect(()=>{const i=o.current,l=window.HTMLInputElement.prototype,x=Object.getOwnPropertyDescriptor(l,"value").set;if(a!==r&&x){const m=new Event("input",{bubbles:!0});x.call(i,r),i.dispatchEvent(m)}},[a,r]),e.jsx("input",{style:{display:"none"},...n,ref:o,defaultValue:r})};function Fr(t=[],r,n){const o=[...t];return o[n]=r,o.sort((a,i)=>a-i)}function st(t,r,n){const i=100/(n-r)*(t-r);return Fe(i,[0,100])}function Tr(t,r){return r>2?`Value ${t+1} of ${r}`:r===2?["Minimum","Maximum"][t]:void 0}function _r(t,r){if(t.length===1)return 0;const n=t.map(a=>Math.abs(a-r)),o=Math.min(...n);return n.indexOf(o)}function Vr(t,r,n){const o=t/2,i=Se([0,50],[0,o]);return(o-i(r)*n)*n}function Kr(t){return t.slice(0,-1).map((r,n)=>t[n+1]-r)}function Br(t,r){if(r>0){const n=Kr(t);return Math.min(...n)>=r}return!0}function Se(t,r){return n=>{if(t[0]===t[1]||r[0]===r[1])return r[0];const o=(r[1]-r[0])/(t[1]-t[0]);return r[0]+o*(n-t[0])}}function Or(t){return(String(t).split(".")[1]||"").length}function Gr(t,r){const n=Math.pow(10,r);return Math.round(t*n)/n}var Lr=Xe,qr=rt,zr=nt,Hr=ot;function $r({className:t,defaultValue:r,value:n,min:o=0,max:a=100,...i}){const l=p.useMemo(()=>Array.isArray(n)?n:Array.isArray(r)?r:[o,a],[n,r,o,a]);return e.jsxs(Lr,{"data-slot":"slider",defaultValue:r,value:n,min:o,max:a,className:ae("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",t),...i,children:[e.jsx(qr,{"data-slot":"slider-track",className:ae("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-1.5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:e.jsx(zr,{"data-slot":"slider-range",className:ae("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:l.length},(b,x)=>e.jsx($t,{children:e.jsxs(Ut,{open:!0,children:[e.jsx(Yt,{asChild:!0,children:e.jsx(Hr,{"data-slot":"slider-thumb",className:"border-primary bg-background ring-ring/20 block size-4 shrink-0 rounded-full border shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},x)}),e.jsx(Jt,{children:l[x]})]})},x))]})}const at=(t,r)=>{if(t==null)return;const[n,...o]=r;if(!n)return t;const a=typeof t=="object"?t[n]:void 0;return o.length&&a!=null?at(a,o):a},he=(t,r,n)=>{if(!r)return t??n;const o=at(t,r.split("."));return o??n},is=({data:t})=>{var r;return[{title:((r=t==null?void 0:t.config)==null?void 0:r.title)||"配置化CRUD页面"}]};function ls(){const{tableData:t={data:[],total:0},config:r={},resourceTable:n}=ar(),o=ir(),a=Te(),i=dt(),l=ut(),b=lr();p.useEffect(()=>{var y;const{err:s,success:c,type:u}=o||{};if(o){if(!c||s){we.error(`${u} 操作失败`,{description:s||"unknown"});return}we.success(`${u} 操作成功`,{description:"success"}),u==="deleteMany"?(y=k.current)==null||y.resetRowSelection():["create","edit"].includes(u||"")&&j()}},[o]);const{tableRecordLink:x=[],tableSql:m,formField:R=[]}=r||{},{data:g}=mt({resource:n,action:ue.delete}),v=p.useRef(void 0),f=p.useRef(void 0),k=p.useRef(void 0),[A,D]=p.useState(!1),E=s=>{const c=s.getSelectedRowModel().rows;return{className:"text-destructive!",label:`Delete Selected (${c.length}) ${l("Row",c.length>1?"plural":"singular")}`,disabled:!(g!=null&&g.can),onClick:()=>{k.current=s;const y=new FormData,w={type:"deleteMany",resourceTable:n,ids:c.map(C=>C.original.id)};y.append("data",JSON.stringify(w)),a(y,{method:"post"})}}},K=p.useMemo(()=>er(m),[m]),T=Array.isArray(x)?x:[],M=Array.isArray(R)?R:[],Y=()=>{const s=K&&K.length>1;if(!s&&!t.data.length)return[];const u=(s?K.map(P=>({name:P})):Object.keys(t.data[0]).map(P=>({name:P}))).map(({name:P})=>{const X=P.charAt(0).toUpperCase()+P.slice(1);let V="string";const N=he(t.data[0],P);typeof N=="number"?V="number":typeof N=="boolean"?V="boolean":N instanceof Date||typeof N=="string"&&/^\d{4}-\d{2}-\d{2}/.test(N)?V="date":typeof N=="object"&&(V="object");let ce;return V==="date"?ce=de=>e.jsx(H.Filter.DateRangePicker,{...de}):V==="string"&&(ce=de=>e.jsx(H.Filter.Search,{...de})),e.jsx(H.Column,{header:X,accessorKey:P,id:P,meta:V==="string"?{filterOperator:"contains"}:void 0,enableSorting:V!=="object",enableHiding:!0,filter:ce,cell:({row:{original:de}})=>{const oe=he(de,P);return oe==null?e.jsx("span",{className:"text-muted-foreground",children:"-"}):V==="boolean"?oe?"true":"false":V==="date"?se(oe).format("YYYY-MM-DD HH:mm:ss"):V==="object"?e.jsxs(Re,{children:[e.jsx(De,{className:"text-link cursor-pointer",asChild:!0,children:e.jsx(me,{variant:"ghost",size:"icon",children:e.jsx(cr,{className:"h-4 w-4"})})}),e.jsx(Ne,{className:"w-auto",children:e.jsx("pre",{className:"text-sm",children:JSON.stringify(oe,null,2)})})]}):oe.toLocaleString()}},P)});r.enableDelete&&u.unshift(e.jsx(H.Column,{accessorKey:"id",id:"checkbox",header:({table:P})=>e.jsx(H.CheckAll,{table:P,options:[E(P)]}),cell:({row:P})=>e.jsx(xe,{className:"ml-2",checked:P.getIsSelected(),onCheckedChange:X=>P.toggleSelected(!!X),"aria-label":"Select row"},`checkbox-${P.original.id}`)},"checkbox"));const{enableDelete:y,enableEdit:w,enableClone:C,tableRecordLink:I}=r,S=w||C||y||(I==null?void 0:I.length);return u.push(e.jsx(H.Column,{header:"Actions",accessorKey:"id",id:"actions",cell:({row:{original:P}})=>S?e.jsx(H.Actions,{row:P,resource:n,children:Q(P,T)}):"N/A"},"actions")),u},Q=(s,c)=>{const u=[];return r.enableEdit&&u.push(e.jsx(H.EditAction,{onClick:()=>{v.current=s,f.current=ue.edit,i.show()}},"edit")),r.enableClone&&u.push(e.jsx(H.CloneAction,{onClick:()=>{v.current=s,f.current=ue.clone,i.show()}},"clone")),r.enableDelete&&u.push(e.jsx(H.DeleteAction,{onClick:()=>{v.current=s,D(!0)}},"delete")),c.length>0&&c.forEach(y=>{u.push(e.jsx(H.ShowAction,{title:y.name,icon:e.jsx(dr,{}),onClick:()=>{let w=y.url;const C=w.match(/\{([^}]+)\}/g);C&&C.forEach(I=>{const S=I.substring(1,I.length-1),P=he(s,S);w=w.replace(I,String(P||""))}),b(w)}},y.name))}),u},Z=Y(),re=[e.jsx(yt,{resource:Zt.dynamicPage,recordItemId:r.id,children:"编辑配置"},"edit"),e.jsx(vt,{resource:n},"export")];r.enableCreate&&re.push(e.jsx(jt,{resource:n,onClick:()=>{v.current=void 0,f.current="create",i.show()}},"create"));const le=p.useMemo(()=>{const s={};return K.filter(c=>c.match(/Id|id$/)).forEach(c=>{s[c]=!1}),s},[K]),J=p.useMemo(()=>{const{orderBy:s}=tr(m),c=K.find(u=>s.includes(u));return c?[{id:c,desc:s.includes("DESC")}]:void 0},[m,K]),_=()=>{var c;const s=new FormData;s.append("data",JSON.stringify({type:"deleteOne",resourceTable:n,id:(c=v.current)==null?void 0:c.id})),a(s,{method:"post"})},[$,U]=p.useState({}),[ne,h]=p.useState(!1);p.useEffect(()=>{var c;if(!i.visible)return;const s={};(c=M==null?void 0:M.filter(u=>rr.includes(u.type)))==null||c.forEach(async u=>{u.optionsStatic&&(s[u.name]=u.optionsStatic),u.optionsType==="database"&&(s[u.name]=await d(u))}),U(s),setTimeout(()=>{h(!0)},100)},[i.visible]);const d=p.useCallback(async s=>{if(!s.optionsSql)return[];const{data:c}=await ke.post("/api/sql",{sql:s.optionsSql,pagination:{mode:"off"}}),u=c.data;return Array.isArray(u)?u:[]},[]),j=()=>{h(!1),i.close()};return r.id?e.jsxs(ft,{fallback:e.jsx(ht,{}),children:[e.jsxs(xt,{children:[e.jsxs(Qt,{children:[e.jsx("span",{children:"配置化CRUD页面 - "}),e.jsx("span",{className:"capitalize",children:n}),e.jsx("p",{className:"text-muted-foreground text-sm font-normal",children:"由配置化CRUD页面生成, 支持配置要展示的数据模型、查询语句、增删改查等交互"})]}),e.jsx(H,{enableSorting:!0,enableFilters:!0,enableHiding:!0,toolbar:re,initialState:{columnVisibility:le,sorting:J},refineCoreProps:{meta:{},resource:n,queryOptions:{initialData:{data:t.data,total:t.total},queryFn:async({queryKey:s=[]})=>{const c=s[3],{filters:u,pagination:y,sorters:w}=c||{},{data:C}=await ke.post("/api/sql",{sql:m,filters:u,pagination:y,sorters:w});return{data:(C==null?void 0:C.data)||[],total:(C==null?void 0:C.total)||0}}}},children:Z})]}),e.jsx(kt,{open:A,onOpenChange:s=>!s&&D(!1),children:e.jsxs(Rt,{children:[e.jsxs(Dt,{children:[e.jsx(Nt,{children:"确认删除记录"}),e.jsx(At,{children:"确定要删除该记录吗？此操作不可撤销。"})]}),e.jsxs(Pt,{children:[e.jsx(Et,{children:"取消"}),e.jsx(Mt,{onClick:_,variant:"destructive",children:"确认删除"})]})]})}),e.jsx(Tt,{open:ne,onOpenChange:j,children:e.jsxs(_t,{className:"sm:max-w-5xl",children:[e.jsxs(Vt,{className:"border-b pb-4",children:[e.jsx(Kt,{children:f.current===ue.edit?`编辑 ${n}`:`新增 ${n}`}),e.jsx(Bt,{children:"表单由CRUD配置化功能生成"})]}),e.jsx(Jr,{action:f.current,formModalClose:j,initialData:v.current,config:r,allOptionsMap:$,resourceTable:n})]})})]}):e.jsx(bt,{})}function cs(){return e.jsx(gt,{})}const Ur=(t={},r,n)=>r.reduce((o,a)=>{var x;const{name:i,type:l}=a,b=n[i]||[];return l==="text"||l==="textarea"||l==="file"||l==="code"||l==="date"?o[i]=t[i]||"":l==="number"?o[i]=t[i]||0:l==="slider"?o[i]=t[i]||[1,90]:["select","radio"].includes(l)?o[i]={label:((x=b.find(m=>m.value===t[i]))==null?void 0:x.label)||"",value:t[i]||""}:o[i]=t[i]||void 0,o},{}),Yr=t=>F.object(t.reduce((r,n)=>{const{name:o,type:a,required:i,min:l,max:b,step:x}=n;let m;switch(a){case"text":case"textarea":m=F.string();break;case"code":m=sr;break;case"number":m=F.number(),typeof l=="number"&&(m=m.min(l)),typeof b=="number"&&(m=m.max(b)),typeof x=="number"&&(m=m.step(x));break;case"switch":case"checkbox":m=F.boolean();break;case"select":case"radio":m=F.object({label:F.string(),value:F.string().or(F.number())});break;case"selectMany":case"checkboxMany":m=F.array(F.object({label:F.string(),value:F.string().or(F.number())}));break;case"date":m=F.string();break;case"dateRange":m=F.object({from:F.string(),to:F.string()});break;case"dateMany":m=F.array(F.string());break;case"file":m=F.any();break;case"slider":m=F.array(F.number());break;default:m=F.any()}return i?m=m.refine(R=>R!=null&&R!=="",{message:`${o} 是必填项`}):m=m.optional(),{...r,[o]:m}},{})),Jr=({initialData:t,formModalClose:r,action:n,config:o,allOptionsMap:a={},resourceTable:i})=>{const{formAction:l,id:b=t==null?void 0:t.id}=pt({action:n}),{formField:x}=o||{},m=Array.isArray(x)?x:[],R=Yr(m),g=Te(),v=Ur(t,m,a),f=it({resolver:lt(R),defaultValues:v,mode:"onChange"}),k="YYYY-MM-DD",A=p.useCallback(h=>{const{name:d,type:j,label:s,description:c,readonly:u,start:y,end:w}=h,C={date:"single",dateMany:"multiple",dateRange:"range"};return e.jsx(G,{control:f.control,name:d,disabled:u,render:({field:I})=>{const{value:S,onChange:P}=I||{};let X,V;return Array.isArray(S)?(X=S.map(N=>new Date(N)),V=S.map(N=>se(N).format(k))):S!=null&&S.from||S!=null&&S.to?(X={from:S.from?new Date(S.from):void 0,to:S.to?new Date(S.to):void 0},V=[S.from,S.to]):S&&(X=new Date(S),V=[S]),e.jsxs(B,{className:"flex flex-col",children:[e.jsxs(O,{children:[s||d,c&&e.jsxs(q,{className:"inline-block",children:[" - ",c]})]}),e.jsxs(Re,{children:[e.jsx(De,{asChild:!0,children:e.jsx(L,{children:e.jsxs(me,{variant:"outline",className:ae("h-auto w-[500px] gap-1 pl-3 text-left font-normal",!S&&"text-muted-foreground",j==="dateMany"&&"w-full"),children:[S?V==null?void 0:V.map(N=>e.jsx(It,{variant:"secondary",children:N},N)):e.jsx("span",{children:"Pick a date"}),e.jsx(ur,{className:"ml-auto h-4 w-4 opacity-50"})]})})}),e.jsx(Ne,{className:"w-auto p-0",align:"start",children:e.jsx(Ft,{defaultMonth:new Date,mode:C[j]||"default",selected:X,onSelect:N=>{Array.isArray(N)?P(N.map(ce=>se(ce).format(k))):N!=null&&N.from||N!=null&&N.to?P({from:se(N.from).format(k),to:se(N.to).format(k)}):P(se(N).format(k))},disabled:u||(N=>N>new Date(w||"")||N<new Date(y||"")),initialFocus:!0,numberOfMonths:j==="date"?2:3})})]}),e.jsx(z,{})]})}},d)},[f.control]),D=p.useCallback(h=>{const{name:d,label:j,description:s,readonly:c}=h,u=a[d]||[];return e.jsx(G,{control:f.control,name:d,disabled:c,render:({field:y})=>{var w;return e.jsxs(B,{children:[e.jsxs(O,{children:[j||d,s&&e.jsxs(q,{className:"inline-block",children:[" - ",s]})]}),e.jsx(L,{children:e.jsxs(kr,{disabled:c,defaultValue:(w=y.value)==null?void 0:w.value,onValueChange:C=>{var I;return y.onChange({label:((I=u.find(S=>S.value===C))==null?void 0:I.label)||"unknown",value:C})},className:"flex gap-6 rounded-md border px-3 py-3.5",children:[!u.length&&e.jsx("div",{className:"text-muted-foreground",children:"No options available"}),u.map(C=>e.jsxs(B,{className:"flex items-center space-y-0",children:[e.jsx(L,{children:e.jsx(Rr,{value:C.value})}),e.jsx(O,{className:"font-normal",children:C.label})]},C.value))]})}),e.jsx(z,{})]})}},d)},[f.control,a]),E=p.useCallback(h=>{const{name:d,label:j,description:s,readonly:c}=h;return e.jsx(G,{control:f.control,name:d,disabled:c,render:({field:u})=>e.jsxs(B,{children:[e.jsxs("div",{className:"flex gap-3 rounded-md border p-3",children:[e.jsx(L,{children:e.jsx(xe,{disabled:c,checked:u.value,onCheckedChange:u.onChange,className:"mt-[2px]"})}),e.jsxs("div",{className:"space-y-1 leading-none",children:[e.jsx(O,{children:j||d}),s&&e.jsx(q,{children:s})]})]}),e.jsx(z,{})]})},d)},[f.control]),K=p.useCallback(h=>{const{name:d,label:j,description:s,readonly:c}=h,u=a[d]||[];return e.jsx(G,{disabled:c,control:f.control,name:d,render:()=>e.jsxs(B,{children:[e.jsxs(O,{className:"text-base",children:[j||d,s&&e.jsxs(q,{className:"inline-block",children:[" - ",s]})]}),e.jsxs("div",{className:"flex gap-6 rounded-md border p-3",children:[!u.length&&e.jsx("div",{className:"text-muted-foreground",children:"No options available"}),u.map(y=>e.jsx(G,{control:f.control,name:d,render:({field:w})=>{const C=w.value||[];return e.jsxs(B,{className:"flex flex-row items-center space-y-0",children:[e.jsx(L,{children:e.jsx(xe,{disabled:c,checked:C.find(I=>(I==null?void 0:I.value)===y.value)!==void 0,onCheckedChange:I=>I?w.onChange([...C,{label:y.label,value:y.value}]):w.onChange(C.filter(S=>(S==null?void 0:S.value)!==y.value))})}),e.jsx(O,{className:"text-sm font-normal",children:y.label})]},y.value)}},y.value))]}),e.jsx(z,{})]})},d)},[f.control,a]),T=p.useCallback(h=>{const{name:d,label:j,description:s,readonly:c,min:u,max:y,step:w}=h;return e.jsx(G,{control:f.control,name:d,disabled:c,render:({field:C})=>e.jsxs(B,{children:[e.jsxs(O,{children:[j||d,s&&e.jsxs(q,{className:"inline-block",children:[" - ",s]})]}),e.jsx(L,{className:"mt-12 w-[70%]",children:e.jsx($r,{disabled:c,value:C.value,onValueChange:C.onChange,minStepsBetweenThumbs:w,min:u,max:y,step:w})}),e.jsx(z,{})]})},d)},[f.control]),M=p.useCallback(h=>{const{name:d,label:j,description:s,readonly:c}=h;return e.jsx(G,{control:f.control,name:d,disabled:c,render:({field:u})=>e.jsxs(B,{className:"mr-2 inline-block flex-row items-center justify-between gap-3 rounded-lg border px-3 pt-2.5 pb-2",children:[e.jsxs(O,{className:"mb-2 block",children:[j||d,s&&e.jsxs(q,{className:"inline-block",children:[" - ",s]})]}),e.jsx(L,{children:e.jsx(Wt,{disabled:c,checked:u.value,onCheckedChange:u.onChange})}),e.jsx(z,{})]})},d)},[f.control]),Y=p.useCallback(h=>{const{name:d,label:j,description:s,readonly:c}=h,u=a[d]||[];return e.jsx(G,{control:f.control,name:d,disabled:c,render:({field:y})=>{var w;return e.jsxs(B,{children:[e.jsxs("div",{className:"space-y-0.5",children:[e.jsx(O,{children:j||d}),s&&e.jsxs(q,{className:"inline-block",children:[" - ",s]})]}),e.jsx(L,{children:e.jsx(St,{disabled:c,options:u,popoverProps:{modal:!0},value:(w=y.value)==null?void 0:w.value,onChange:C=>{var I;return y.onChange({label:((I=u.find(S=>S.value===C))==null?void 0:I.label)||"unknown",value:C})}})}),e.jsx(z,{})]})}},d)},[f.control,a]),Q=p.useCallback(h=>{const{name:d,label:j,description:s,readonly:c,min:u,max:y,step:w}=h;return e.jsx(G,{control:f.control,name:d,disabled:c,render:({field:C})=>e.jsxs(B,{children:[e.jsxs(O,{children:[j||d,s&&e.jsxs(q,{className:"inline-block",children:[" - ",s]})]}),e.jsx(L,{children:e.jsx(pe,{disabled:c,type:"number",min:u,max:y,step:w,value:C.value,onChange:I=>C.onChange(Number(I.target.value))})}),e.jsx(z,{})]})},d)},[f.control]),Z=p.useCallback(h=>{const{name:d,label:j,description:s,readonly:c}=h;return e.jsx(G,{control:f.control,name:d,disabled:c,render:({field:u})=>e.jsxs(B,{children:[e.jsxs(O,{children:[j||d,s&&e.jsxs(q,{className:"inline-block",children:[" - ",s]})]}),e.jsx(L,{children:e.jsx(pe,{disabled:c,value:u.value,onChange:y=>u.onChange(y.target.value)})}),e.jsx(z,{})]})},d)},[f.control]),re=p.useCallback(h=>{const{name:d,label:j,description:s,readonly:c}=h;return e.jsx(G,{control:f.control,name:d,disabled:c,render:({field:u})=>e.jsxs(B,{children:[e.jsxs(O,{children:[j||d,s&&e.jsxs(q,{className:"inline-block",children:[" - ",s]})]}),e.jsx(L,{children:e.jsx(pe,{disabled:c,type:"file",value:u.value,onChange:y=>u.onChange(y.target.value)})}),e.jsx(z,{})]})},d)},[f.control]),le=p.useCallback(h=>{const{name:d,label:j,description:s,readonly:c}=h;return e.jsx(G,{control:f.control,name:d,disabled:c,render:({field:u})=>e.jsxs(B,{children:[e.jsxs(O,{children:[j||d,s&&e.jsxs(q,{className:"inline-block",children:[" - ",s]})]}),e.jsx(L,{children:e.jsx(Xt,{disabled:c,className:"min-h-20",value:u.value,onChange:y=>u.onChange(y.target.value)})}),e.jsx(z,{})]})},d)},[f.control]),J=p.useCallback(h=>{const{name:d,label:j,description:s,readonly:c}=h,u=a[d];return e.jsx(G,{control:f.control,name:d,disabled:c,render:({field:y})=>e.jsxs(B,{children:[e.jsxs(O,{children:[j||d,s&&e.jsxs(q,{className:"inline-block",children:[" - ",s]})]}),e.jsx(L,{children:e.jsx(wt,{disabled:c,options:u,popoverProps:{modal:!0},value:y.value,onChange:w=>y.onChange(w)})}),e.jsx(z,{})]})},d)},[f.control,a]),_=p.useCallback(h=>{const{name:d,label:j,description:s,readonly:c,language:u="json"}=h;return e.jsx(G,{control:f.control,name:d,disabled:c,render:({field:y})=>e.jsxs(B,{children:[e.jsxs(O,{children:[j||d,s&&e.jsxs(q,{className:"inline-block",children:[" - ",s]})]}),e.jsx(L,{children:e.jsx(Ct,{options:{readOnly:c},language:u,height:"20vh",value:y.value,onChange:w=>y.onChange(w)})}),e.jsx(z,{})]})},d)},[f.control]),$=h=>{switch(h.type){case"text":return Z(h);case"textarea":return le(h);case"file":return re(h);case"selectMany":return J(h);case"code":return _(h);case"number":return Q(h);case"select":return Y(h);case"radio":return D(h);case"switch":return M(h);case"slider":return T(h);case"date":case"dateRange":case"dateMany":return A(h);case"checkbox":return E(h);case"checkboxMany":return K(h);default:return null}},U=p.useCallback(h=>{const d=nr(h,v);return Object.keys(h).forEach(j=>{var c;const s=((c=m.find(u=>u.name===j))==null?void 0:c.type)||"";["select","radio"].includes(s)&&(d[j]=h[j].value)}),or(d)},[v]),ne=h=>{const d=U(h),j=new FormData;j.append("data",JSON.stringify({...d,type:l,id:b,resourceTable:i})),g(j,{method:"post"})};return e.jsx(ct,{...f,children:e.jsxs("form",{onSubmit:f.handleSubmit(ne),className:"space-y-4 py-2",children:[m.map(h=>$(h)),e.jsxs(Ot,{children:[e.jsx(me,{variant:"outline",type:"button",onClick:r,children:"取消"}),e.jsx(me,{type:"submit",icon:e.jsx(mr,{}),children:"保存"})]})]})})};export{cs as ErrorBoundary,ls as default,is as meta};
