import{j as e}from"./jsx-runtime-C-_spy54.js";import{H as L}from"./index-hdkCHUwo.js";import{t}from"./i18next-BaiEmIpz.js";import{r as c}from"./index-aGVi9Z7h.js";import{B as N}from"./button-hXZAo1l1.js";import{I as d}from"./input-CqjlsziW.js";import{L as m}from"./label-CQrdb056.js";import{a as F}from"./resources-nPXTaVLM.js";import{E as i,T as I,P}from"./tcsk-oauth2-Hdf1kRVD.js";import{a as R,d as A,F as V,L as y}from"./components-CzmxjdGq.js";import{a as q}from"./index-DN0hhrBY.js";import z from"./gallery-vertical-end-DU-tXM4l.js";import"./index-BivEtBZR.js";import"./user-BZJo8VNU.js";function O(){var f,g,h,j;const{errors:s}=R()||{},[b]=A(),p=b.get("redirectTo")||F,w=q(),{open:a}=L(),[C,x]=c.useState(!1),[n,u]=c.useState(0),[o,E]=c.useState("administrator@goodman.com");async function S(l){x(!0);try{const r=await fetch("/api/send-code",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:l})}),T=await r.json();if(!r.ok)throw new Error(T.error||"发送验证码失败");a==null||a({key:"register-email-sent",message:"验证码已发送",description:"请查看您的邮箱",type:"success"}),u(60);const k=setInterval(()=>{u(v=>v<=1?(clearInterval(k),0):v-1)},1e3)}catch(r){a==null||a({key:"register-email-sent",message:"Error",description:r instanceof Error?r.message:"发送验证码失败",type:"error"})}finally{x(!1)}}return e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs(V,{method:"post",children:[e.jsx("input",{type:"hidden",name:"redirectTo",value:p}),e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsxs(y,{prefetch:"intent",viewTransition:!0,to:"/",className:"flex flex-col items-center gap-2 font-medium",children:[e.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-md",children:e.jsx(z,{className:"size-6"})}),e.jsx("span",{className:"sr-only",children:"Remix Inc."})]}),e.jsx("h1",{className:"text-xl font-bold",children:t("pages.register.title")}),e.jsxs("div",{className:"text-center text-sm",children:[t("pages.register.haveAccount"),e.jsx(y,{prefetch:"intent",viewTransition:!0,to:"/login",replace:!0,className:"underline underline-offset-4",children:t("pages.register.signin")})]})]}),e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsxs("div",{className:"grid gap-2",children:[e.jsx(m,{htmlFor:"email",children:t("pages.register.fields.email")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{name:"email",id:"email",type:"email",placeholder:"Goodman@example.com",required:!0,autoFocus:!0,autoComplete:"email",value:o,onChange:l=>E(l.target.value)}),e.jsx(N,{className:"h-9",type:"button",disabled:C||n>0||!o,variant:"outline",onClick:()=>S(o),children:n>0?`${n}s`:"Send Code"})]}),e.jsx(i,{error:(f=s==null?void 0:s.email)==null?void 0:f[0]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(m,{htmlFor:"code",children:t("pages.register.fields.validateCode")}),e.jsx(d,{name:"code",id:"code",type:"code",required:!0,minLength:8,maxLength:6,defaultValue:"123456"}),e.jsx(i,{error:(g=s==null?void 0:s.code)==null?void 0:g[0]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(m,{htmlFor:"password",children:t("pages.register.fields.password")}),e.jsx(d,{name:"password",id:"password",type:"password",required:!0,autoComplete:"new-password",minLength:8,maxLength:32,defaultValue:"Abc@12345678"}),e.jsx(i,{error:(h=s==null?void 0:s.password)==null?void 0:h[0]})]}),e.jsxs("div",{className:"grid gap-2",children:[e.jsx(N,{type:"submit",className:"w-full",disabled:w.state==="submitting",children:t("pages.register.buttons.submit")}),e.jsx(i,{error:(j=s==null?void 0:s.default)==null?void 0:j[0]})]})]}),e.jsx("div",{className:"after:border-border relative text-center text-sm after:absolute after:inset-0 after:top-1/2 after:z-0 after:flex after:items-center after:border-t",children:e.jsx("span",{className:"bg-background text-muted-foreground relative z-10 px-2",children:"or"})}),e.jsx(I,{redirectTo:p})]})]}),e.jsx(P,{})]})}const _=()=>[{title:"Register"}];function ee(){return e.jsx("div",{className:"bg-background flex min-h-svh flex-col items-center justify-center gap-6 p-6 md:p-10",children:e.jsx("div",{className:"w-full max-w-sm",children:e.jsx(O,{})})})}export{ee as default,_ as meta};
