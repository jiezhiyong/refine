import{j as o}from"./jsx-runtime-C-_spy54.js";import{t as E}from"./form-DJOXBopy.js";import{a as C,P as S}from"./index-hdkCHUwo.js";import{C as y,F as m}from"./field-Db2otRYH.js";import{r as P}from"./index-aGVi9Z7h.js";import{P as T}from"./500-B3AgJgcX.js";import{C as v}from"./clone-De2if-gT.js";import{D as F}from"./delete-CwOPg-Sh.js";import{S as I}from"./show-ZW59zqNK.js";import{C as D}from"./combobox-BFvOMOv3.js";import{F as N}from"./form-BJ9AhYXH.js";import{S as O}from"./select-DbQ9Ma6E.js";import{D as w,a as A,b as B,c as R,d as U}from"./dialog-CHC2yo7K.js";import{I as V}from"./input-DDJ0ggOh.js";import{T as q}from"./textarea-J2qc-DG5.js";import{E as x}from"./action-DSYjqVEc.js";import{a as z,E as L}from"./post-BInKrOu8.js";import{E as M}from"./resource-BEg55So-.js";import{g as _,d as k}from"./get-changed-values-vLde9APN.js";import{g as H}from"./form-BJoh7EuQ.js";import{g as K}from"./get-default-title-CrVGbO9H.js";import{s as d}from"./post-IjVlnkkq.js";import{u as Q}from"./components-CzmxjdGq.js";import{i as W}from"./isEqual-KSD6Iy0l.js";const Co=({matches:e})=>[{title:K(e)}],So={uiTools:()=>o.jsx(G,{})};function yo(){const{initialData:e}=Q();return o.jsx(h,{initialData:e})}function G(){return o.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[o.jsx(I,{variant:"ghost",size:"icon"}),o.jsx(v,{variant:"ghost",size:"icon"}),o.jsx(F,{variant:"ghost",size:"icon",className:"text-destructive!"})]})}function Po(){return o.jsx(T,{})}const J=e=>({title:(e==null?void 0:e.title)||"",content:(e==null?void 0:e.content)||"",status:(e==null?void 0:e.status)||L.DRAFT,categoryId:(e==null?void 0:e.categoryId)||""}),h=({className:e,redirect:i=x.list,initialData:r,formModalClose:n,action:a})=>{const{formAction:l,id:g=r==null?void 0:r.id,identifier:j}=C({action:a}),b=S({resource:M.category,pagination:{mode:"off"}}).options,u=l===x.edit,c=J(r),t=y({resolver:E(d),defaultValues:c,warnWhenUnsavedChanges:!0,mode:"onChange",refineCoreProps:{resource:j,action:l,id:g,queryOptions:H(c),redirect:i,autoSave:{enabled:u,debounce:2e3,invalidateOnUnmount:!0,onFinish:s=>{try{if(d.parse(s),W(s,t.formState.defaultValues))throw new Error("表单内容未变化");return p(s)}catch{return null}}}}}),p=P.useCallback(s=>{const f=_(s,c);return k(f)},[]);return o.jsxs(N,{...t,autoSave:u,beforeSubmit:p,className:e,formModalClose:n,recordItemId:r==null?void 0:r.id,children:[o.jsx(m,{...t,name:"title",label:"Title",children:o.jsx(V,{placeholder:"Title"})}),o.jsx(m,{...t,name:"categoryId",label:"Category",children:o.jsx(D,{options:b,popoverProps:{modal:!!n}})}),o.jsx(m,{...t,name:"status",label:"Status",children:o.jsx(O,{options:z.map(s=>({label:s,value:s}))})}),o.jsx(m,{...t,name:"content",label:"Content",children:o.jsx(q,{placeholder:"Content",className:"min-h-60"})})]})};function To(e){const{visible:i,close:r,record:n,action:a}=e;return o.jsx(w,{open:i,onOpenChange:r,children:o.jsxs(A,{className:"sm:max-w-6xl",children:[o.jsxs(B,{className:"border-b pb-4",children:[o.jsx(R,{children:"Edit Post"}),o.jsx(U,{children:"This is a Demo for Edit Form on Modal."})]}),o.jsx(h,{action:a,className:"p-0",formModalClose:r,initialData:n})]})})}export{Po as E,h as P,To as a,yo as b,So as h,Co as m};
