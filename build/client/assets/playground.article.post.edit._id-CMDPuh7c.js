import{j as e,r as p}from"./index-B4K3Jj8V.js";import{F as P,U as F,b as B,z as m,c as N,t as k,a as f,C as _,S as z,T as U}from"./textarea-DuNfuQEU.js";import{z as O,p as A,M as L,a4 as M,S as H,P as $}from"./index-DwnvTw0e.js";import{d as q}from"./dayjs.min-DoqX9pzC.js";import{a as v,B as S,S as V}from"./button-UAd1uCbk.js";import"./api.auth._provider.callback-B7nnFBLb.js";import"./index-CVWMrdoV.js";import{C as K,a as W,b as G}from"./card-BaeXXXnI.js";import{E as h,D as J,k as Q,l as X,m as Y,n as Z}from"./index-BWvXPdnM.js";import{P as R}from"./500-naGbbnIq.js";import{I as ee}from"./input-CjHTLoMm.js";import{E as j}from"./resources-CY0CfhSA.js";import{b as te}from"./post-CCEhhlTv.js";import{g as ae}from"./get-default-title-CAvEf6Vo.js";import{u as ne}from"./components-C3jcH-a4.js";import{S as se}from"./show-DfjkSx2P.js";import{D as re}from"./delete-aAC3uzQM.js";import{C as oe}from"./clone-DGU-dQgw.js";(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},s=new t.Error().stack;s&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[s]="d1381688-ef1f-4ae5-b246-eab3d798ebf2",t._sentryDebugIdIdentifier="sentry-dbid-d1381688-ef1f-4ae5-b246-eab3d798ebf2")}catch{}})();const ie=({status:t,elements:{success:s=e.jsx(x,{translationKey:"autoSave.success",defaultMessage:"saved"}),error:a=e.jsx(x,{translationKey:"autoSave.error",defaultMessage:"auto save failed"}),loading:o=e.jsx(x,{translationKey:"autoSave.loading",defaultMessage:"saving ..."}),idle:l=e.jsx(x,{translationKey:"autoSave.idle",defaultMessage:"waiting for changes ..."})}={}})=>{switch(t){case"success":return e.jsx(e.Fragment,{children:s});case"error":return e.jsx(e.Fragment,{children:a});case"loading":return e.jsx(e.Fragment,{children:o});default:return e.jsx(e.Fragment,{children:l})}},x=({translationKey:t,defaultMessage:s})=>{const a=O();return e.jsxs("span",{className:v("text-sm text-muted-foreground",{"text-destructive":t==="autoSave.error","text-green-500":t==="autoSave.success"}),children:[a(t,s),t==="autoSave.success"&&` at ${q().format("HH:mm:ss")}`]})},le=({autoSave:t,modifyingDataBeforeSubmission:s,formProps:a,isWatchable:o,saveButtonProps:l,className:d,useFormModalClose:r,recordItemId:c,...n})=>{const u=p.useRef(!1),{resource:b,action:i}=A(),T=L(),I=i!==h.list||typeof i<"u"?T:void 0;o&&!u.current&&(u.current=!0,n.watch());const w=n.handleSubmit(me=>{const g=n.getValues(),E=s?s(g):g;n.refineCore.onFinish(E),r==null||r()}),{disabled:C}=l||{};return e.jsx(P,{...n,children:e.jsx("form",{...a,onSubmit:w,children:e.jsxs(K,{className:v("mx-auto space-y-4 border-none p-8 shadow-none",d),children:[e.jsx(W,{className:"space-y-4 p-0",children:n.children}),e.jsxs(G,{className:"flex gap-x-2 p-0",children:[e.jsx(y,{type:"submit",recordItemId:c,loading:n.refineCore.formLoading,disabled:C||!n.formState.isDirty}),!n.hideCancel&&e.jsx(S,{icon:e.jsx(F,{}),type:"button",onClick:r||I,disabled:n.refineCore.formLoading,variant:"outline",children:"Cancel"}),t&&e.jsx("div",{className:"ml-auto",children:e.jsx(ie,{...n.refineCore.autoSaveProps})})]})]})})})},y=({hideText:t=!1,children:s,accessControl:a,access:o,resource:l,recordItemId:d,...r})=>{const{label:c}=M(),n=a!=null&&a.enabled?H:V;return a!=null&&a.hideIfUnauthorized&&a.enabled?null:e.jsx(n,{params:{id:d},resource:l,action:"save",...o,children:e.jsx(S,{icon:e.jsx(B,{}),...r,children:!t&&(s??c)})})};y.displayName="SaveButton";const Be=({matches:t})=>[{title:ae(t)}],Ne={uiTools:()=>e.jsx(de,{})};function ke(){const{initialData:t,categoriesRes:s}=ne();return e.jsx(D,{initialData:t,categoriesRes:s})}function de(){return e.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[e.jsx(se,{variant:"ghost",size:"icon"}),e.jsx(re,{variant:"ghost",size:"icon"}),e.jsx(oe,{variant:"ghost",size:"icon"})]})}function _e(){return e.jsx(R,{})}const ce=m.object({title:m.string().min(2,{message:"Title must be at least 2 characters."}),content:m.string().min(2),status:m.string(),categoryId:m.string()}),ue=t=>{if(t)return{title:t.title,content:t.content,status:t.status,categoryId:t.categoryId}},D=({className:t,redirect:s=h.list,initialData:a,categoriesRes:o,useFormModalClose:l})=>{var b;let d=[];o?d=(b=o==null?void 0:o.data)==null?void 0:b.map(i=>({label:i.title,value:i.id})):d=$({resource:j.category}).options;const{data:r}=a||{},c=!0,n=N({resolver:k(ce),defaultValues:ue(r),warnWhenUnsavedChanges:!0,refineCoreProps:{resource:j.post,action:r!=null&&r.id?h.edit:h.create,id:r==null?void 0:r.id,queryOptions:a?{queryFn:()=>a,initialData:a}:void 0,redirect:s,autoSave:{enabled:c,debounce:2e3,invalidateOnUnmount:!0,onFinish:i=>u(i)}}}),u=p.useCallback(i=>({...i}),[]);return e.jsxs(le,{...n,autoSave:c,modifyingDataBeforeSubmission:u,className:t,useFormModalClose:l,recordItemId:r==null?void 0:r.id,children:[e.jsx(f,{...n,name:"title",label:"Title",children:e.jsx(ee,{placeholder:"Title"})}),e.jsx(f,{...n,name:"categoryId",label:"Category",children:e.jsx(_,{options:d,popoverProps:{modal:!!l}})}),e.jsx(f,{...n,name:"status",label:"Status",children:e.jsx(z,{options:te.map(i=>({label:i,value:i}))})}),e.jsx(f,{...n,name:"content",label:"Content",children:e.jsx(U,{placeholder:"Content",rows:10})})]})};function ze(t){const{visible:s,close:a,record:o}=t;return e.jsx(J,{open:s,onOpenChange:a,children:e.jsxs(Q,{className:"max-w-6xl",children:[e.jsxs(X,{className:"border-b pb-4",children:[e.jsx(Y,{children:"Edit Post"}),e.jsx(Z,{children:"This is a Demo for Edit Form on Modal."})]}),e.jsx(D,{className:"p-0",useFormModalClose:a,initialData:o?{data:{...o}}:void 0})]})})}export{_e as E,D as P,ze as a,ke as b,Ne as h,Be as m};
//# sourceMappingURL=playground.article.post.edit._id-CMDPuh7c.js.map
