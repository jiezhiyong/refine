{"version":3,"file":"system.admin.log.show._id-t132UQfp.js","sources":["../../../app/routes/system.admin.log.show.$id.tsx"],"sourcesContent":["import { Log } from '@prisma/client';\nimport { LoaderFunctionArgs } from '@remix-run/node';\nimport { useLoaderData } from '@remix-run/react';\nimport { CalendarIcon, LeafyGreen, MailIcon } from 'lucide-react';\n\nimport { PageError } from '~/components';\nimport { Avatar, AvatarFallback, AvatarImage } from '~/components-shadcn/avatar';\nimport { Badge } from '~/components-shadcn/badge';\nimport { Label } from '~/components-shadcn/label';\nimport { H1 } from '~/components-shadcn/typography';\nimport { EnumResource } from '~/constants';\nimport { dataService } from '~/services';\nimport { LOG_STATUS_MAP, LogStatus, TAny } from '~/types';\n\nexport async function loader({ params }: LoaderFunctionArgs) {\n  const { id } = params;\n\n  const { data: log } = await dataService.getOne<Log & { user: { name: string; email: string; avatar?: string } }>({\n    resource: EnumResource.log,\n    id: id as string,\n    meta: {\n      include: {\n        user: {\n          select: { name: true, email: true, avatar: true },\n        },\n      },\n    },\n  });\n\n  if (!log) {\n    throw new Response('未找到日志记录', { status: 404 });\n  }\n\n  return { log };\n}\n\nexport default function LogShow() {\n  const { log } = useLoaderData<typeof loader>();\n\n  const data = JSON.parse(log.data || '{}');\n  const previousData = JSON.parse(log.previousData || '{}');\n  const meta = JSON.parse(log.meta || '{}');\n\n  return (\n    <article className=\"px-8 pt-8 pb-4\">\n      <header className=\"mb-8\">\n        <H1 className=\"relative mb-4 inline-flex gap-3 text-4xl font-bold\">\n          <span className=\"capitalize\">\n            Audit Log Detail - {meta.parent}.{log.resource}\n          </span>\n          <div className=\"inline-flex shrink-0 items-start pt-3.5\">\n            <Badge className=\"tracking-wide\" variant={LOG_STATUS_MAP[log.action as LogStatus]?.badge as TAny}>\n              {log.action}\n            </Badge>\n          </div>\n        </H1>\n\n        <div className=\"text-muted-foreground mb-8 flex flex-wrap items-center gap-4 text-sm\">\n          <div className=\"flex items-center\">\n            <LeafyGreen className=\"mr-2 h-4 w-4\" />\n            <span>\n              Resource: {meta.parent}.{log.resource}\n            </span>\n          </div>\n          <div className=\"flex items-center\">\n            <CalendarIcon className=\"mr-2 h-4 w-4\" />\n            <span>Created: {new Date(log.createdAt).toLocaleDateString()}</span>\n          </div>\n        </div>\n\n        <div className=\"flex items-center gap-4\">\n          <Avatar>\n            <AvatarImage src={log.user?.avatar || ''} alt={log.user?.name || ''} />\n            <AvatarFallback>{log.user?.name?.slice(0, 2).toUpperCase()}</AvatarFallback>\n          </Avatar>\n          <div>\n            <p className=\"font-medium\">{log.user?.name}</p>\n            <p className=\"text-muted-foreground flex items-center text-sm\">\n              <MailIcon className=\"mr-2 h-4 w-4\" />\n              {log.user?.email}\n            </p>\n          </div>\n        </div>\n      </header>\n\n      <div className=\"space-y-6\">\n        {log.data && (\n          <div>\n            <Label>Data</Label>\n            <pre className=\"bg-muted mt-1 overflow-x-auto rounded-lg p-4 text-sm whitespace-pre\">\n              {JSON.stringify(data, null, 2)}\n            </pre>\n          </div>\n        )}\n\n        {log.previousData && (\n          <div>\n            <Label>Previous Data</Label>\n            <pre className=\"bg-muted mt-1 overflow-x-auto rounded-lg p-4 text-sm whitespace-pre\">\n              {JSON.stringify(previousData, null, 2)}\n            </pre>\n          </div>\n        )}\n\n        {log.meta && (\n          <div>\n            <Label>Meta Data</Label>\n            <pre className=\"bg-muted mt-1 overflow-x-auto rounded-lg p-4 text-sm whitespace-pre\">\n              {JSON.stringify(meta, null, 2)}\n            </pre>\n          </div>\n        )}\n      </div>\n    </article>\n  );\n}\n\n// 错误边界处理\nexport function ErrorBoundary() {\n  return <PageError />;\n}\n"],"names":["LogShow","log","useLoaderData","data","JSON","parse","previousData","meta","jsxs","className","children","H1","parent","resource","jsx","Badge","variant","LOG_STATUS_MAP","action","badge","LeafyGreen","CalendarIcon","Date","createdAt","toLocaleDateString","Avatar","AvatarImage","src","user","avatar","alt","name","AvatarFallback","slice","toUpperCase","MailIcon","email","Label","stringify","ErrorBoundary","PageError"],"mappings":"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"}